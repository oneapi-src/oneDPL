

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Functions &#8212; oneDPL Documentation 2022.7.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'dynamic_selection_api/functions';</script>
    <link rel="shortcut icon" href="../_static/favicons.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Policies" href="policies.html" />
    <link rel="prev" title="Dynamic Selection API" href="../dynamic_selection_api_main.html" />

    <script defer type="text/javascript" src="https://www.intel.com/content/dam/www/global/wap/performance-config.js" ></script>
    <script type="text/javascript">
        // Configure TMS settings
        var wapLocalCode = 'us-en'; // Dynamically set per localized site, see mapping table for values
        var wapSection = "oneapi-dpl"; // WAP team will give you a unique section for your site
        // Load TMS
        if(document.location.href.includes("oneapi-src.github.io")){
        (function () {
        var url = 'https://www.intel.com/content/dam/www/global/wap/tms-loader.js'; // WAP file URL
        var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true; po.src = url;
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
        })();
        }
    </script>
    <link href="../_static/style.css" rel="stylesheet" type="text/css">



  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/oneAPI-rgb-rev-100.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/oneAPI-rgb-rev-100.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Get Started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../introduction/release_notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction/onedpl_gsg.html">Get Started with the oneAPI DPC++ Library</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Core Functionality</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">oneAPI DPC++ Library Introduction</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../parallel_api_main.html">Parallel API</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../parallel_api/execution_policies.html">Execution Policies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../parallel_api/parallel_range_algorithms.html">Parallel Range Algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../parallel_api/additional_algorithms.html">Additional Algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../parallel_api/pass_data_algorithms.html">Pass Data to Algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../parallel_api/iterators.html">Iterators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../parallel_api/range_based_api.html">Experimental Range-Based API</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api_for_sycl_kernels_main.html">API for SYCL* Kernels</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../api_for_sycl_kernels/tested_standard_cpp_api.html">Tested Standard C++ APIs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_for_sycl_kernels/random.html">Random Number Generators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_for_sycl_kernels/utility_function_object_classes.html">Utility Function Object Classes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../macros.html">Macros</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cmake_support.html">CMake Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../oneDPL_2022.0_changes.html">oneDPL 2022 Breaking Changes</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Technology Preview</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../parallel_api/async_api.html">Asynchronous Algorithms</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../dynamic_selection_api_main.html">Dynamic Selection API</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Functions</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="policies.html">Policies</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="fixed_resource_policy.html">Fixed-Resource Policy</a></li>
<li class="toctree-l3"><a class="reference internal" href="round_robin_policy.html">Round-Robin Policy</a></li>
<li class="toctree-l3"><a class="reference internal" href="dynamic_load_policy.html">Dynamic Load Policy</a></li>
<li class="toctree-l3"><a class="reference internal" href="auto_tune_policy.html">Auto-Tune Policy</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../kernel_templates_main.html">Kernel Templates API</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../kernel_templates/kernel_configuration.html">Kernel Configuration</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../kernel_templates/esimd_main.html">ESIMD-Based Kernel Templates</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../kernel_templates/esimd/radix_sort.html">Radix Sort</a></li>
<li class="toctree-l3"><a class="reference internal" href="../kernel_templates/esimd/radix_sort_by_key.html">Radix Sort By Key</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../kernel_templates/single_pass_scan.html">Inclusive Scan</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Notices and Disclaimers</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../notices_disclaimers.html">Notices and Disclaimers</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/oneapi-src/oneDPL/edit/main/documentation/library_guide/dynamic_selection_api/functions.rst" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/oneapi-src/oneDPL/issues/new?title=Issue%20on%20page%20%2Fdynamic_selection_api/functions.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/dynamic_selection_api/functions.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Functions</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#select">Select</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#submit">Submit</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#submit-using-a-policy">Submit Using a Policy</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#submit-using-a-selection">Submit Using a Selection</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#wait">Wait</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#submit-and-wait">Submit and Wait</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#submit-and-wait-using-a-policy">Submit and Wait Using a Policy</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#submit-and-wait-using-a-selection">Submit and Wait Using a Selection</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#policy-queries">Policy Queries</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-the-resource-options">Getting the Resource Options</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-the-group-of-submissions">Getting the Group of Submissions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#report">Report</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reporting-events-with-no-associated-values">Reporting Events with No Associated Values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reporting-events-with-associated-values">Reporting Events with Associated Values</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <div class="section" id="functions">
<h1>Functions<a class="headerlink" href="#functions" title="Permalink to this headline">#</a></h1>
<p>The dynamic selection API is an experimental feature in the oneAPI DPC++ Library
(oneDPL) that selects an <em>execution resource</em> based on a chosen
<em>selection policy</em>. There are several functions provided as part
of the API.</p>
<div class="section" id="select">
<h2>Select<a class="headerlink" href="#select" title="Permalink to this headline">#</a></h2>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">namespace</span><span class="w"> </span><span class="nn">oneapi</span><span class="o">::</span><span class="nn">dpl</span><span class="o">::</span><span class="nn">experimental</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">Policy</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span><span class="p">...</span><span class="w"> </span><span class="n">Args</span><span class="o">&gt;</span>
<span class="w">  </span><span class="n">selection_t</span><span class="o">&lt;</span><span class="n">Policy</span><span class="o">&gt;</span><span class="w"> </span><span class="n">select</span><span class="p">(</span><span class="n">Policy</span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">Args</span><span class="o">&amp;&amp;</span><span class="p">...</span><span class="w"> </span><span class="n">args</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The function <code class="docutils literal notranslate"><span class="pre">select</span></code> chooses a resource (the <em>selection</em>) based on the
policy <code class="docutils literal notranslate"><span class="pre">p</span></code>. Whether any additional arguments are needed or considered
depends on the policy.</p>
<p>An example that calls <code class="docutils literal notranslate"><span class="pre">select</span></code> using a <code class="docutils literal notranslate"><span class="pre">round_robin_policy</span></code>:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;oneapi/dpl/dynamic_selection&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;sycl/sycl.hpp&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span>

<span class="k">namespace</span><span class="w"> </span><span class="nn">ex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nn">oneapi</span><span class="o">::</span><span class="nn">dpl</span><span class="o">::</span><span class="nn">experimental</span><span class="p">;</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">ex</span><span class="o">::</span><span class="n">round_robin_policy</span><span class="w"> </span><span class="n">p</span><span class="p">{</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">sycl</span><span class="o">::</span><span class="n">queue</span><span class="p">{</span><span class="w"> </span><span class="n">sycl</span><span class="o">::</span><span class="n">cpu_selector_v</span><span class="w"> </span><span class="p">},</span>
<span class="w">                              </span><span class="n">sycl</span><span class="o">::</span><span class="n">queue</span><span class="p">{</span><span class="w"> </span><span class="n">sycl</span><span class="o">::</span><span class="n">gpu_selector_v</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">};</span>

<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">selection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ex</span><span class="o">::</span><span class="n">select</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ex</span><span class="o">::</span><span class="n">unwrap</span><span class="p">(</span><span class="n">selection</span><span class="p">);</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;selected queue is &quot;</span>
<span class="w">              </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="p">((</span><span class="n">q</span><span class="p">.</span><span class="n">get_device</span><span class="p">().</span><span class="n">is_gpu</span><span class="p">())</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s">&quot;gpu</span><span class="se">\n</span><span class="s">&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;cpu</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The output of this example is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">selected</span> <span class="n">queue</span> <span class="ow">is</span> <span class="n">cpu</span>
<span class="n">selected</span> <span class="n">queue</span> <span class="ow">is</span> <span class="n">gpu</span>
<span class="n">selected</span> <span class="n">queue</span> <span class="ow">is</span> <span class="n">cpu</span>
<span class="n">selected</span> <span class="n">queue</span> <span class="ow">is</span> <span class="n">gpu</span>
<span class="n">selected</span> <span class="n">queue</span> <span class="ow">is</span> <span class="n">cpu</span>
<span class="n">selected</span> <span class="n">queue</span> <span class="ow">is</span> <span class="n">gpu</span>
</pre></div>
</div>
<p>The object returned by <code class="docutils literal notranslate"><span class="pre">select</span></code> is a <em>selection</em>. The exact type of the
selection object depends on the policy. If it is necessary to know the exact
type, it can be determined by using traits:
<code class="docutils literal notranslate"><span class="pre">policy_trait&lt;Policy&gt;::selection_type</span></code> or the helper trait <code class="docutils literal notranslate"><span class="pre">selection_t&lt;Policy&gt;</span></code>.</p>
<p>Unwrapping a <em>selection</em> returns the underlying resource. For example, unwrapping
a selection when using SYCL (the default) results in a SYCL queue.</p>
<p>A selection can also be used to report <em>execution info</em>. More advanced policies,
such as <code class="docutils literal notranslate"><span class="pre">dynamic_load_policy</span></code> and <code class="docutils literal notranslate"><span class="pre">auto_tune_policy</span></code> require that runtime
execution information be reported back through the selection object when the
selection resource is used.</p>
<p>When possible, the selection should be passed to a <code class="docutils literal notranslate"><span class="pre">submit</span></code> or <code class="docutils literal notranslate"><span class="pre">submit_and_wait</span></code> function as the mechanism for submitting work to the resource. The <code class="docutils literal notranslate"><span class="pre">submit</span></code> and
<code class="docutils literal notranslate"><span class="pre">submit_and_wait</span></code> functions implement the reporting of execution information
needed by some policies, such as <code class="docutils literal notranslate"><span class="pre">dynamic_load_policy</span></code> and <code class="docutils literal notranslate"><span class="pre">auto_tune_poliy</span></code>.
If the selected resource is used directly, this reporting must be done explicitly
(using the <code class="docutils literal notranslate"><span class="pre">report</span></code> functions).</p>
</div>
<div class="section" id="submit">
<h2>Submit<a class="headerlink" href="#submit" title="Permalink to this headline">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">submit</span></code> has two function signatures:</p>
<ol class="arabic simple">
<li><p>the first argument is a <em>policy</em> object.</p></li>
<li><p>the first argument is a <em>selection</em> object that was returned by a previous call to <code class="docutils literal notranslate"><span class="pre">select</span></code>.</p></li>
</ol>
<div class="section" id="submit-using-a-policy">
<h3>Submit Using a Policy<a class="headerlink" href="#submit-using-a-policy" title="Permalink to this headline">#</a></h3>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">namespace</span><span class="w"> </span><span class="nn">oneapi</span><span class="o">::</span><span class="nn">dpl</span><span class="o">::</span><span class="nn">experimental</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">Policy</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span><span class="w"> </span><span class="nc">F</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span><span class="p">...</span><span class="w"> </span><span class="n">Args</span><span class="o">&gt;</span>
<span class="w">  </span><span class="n">submission_t</span><span class="o">&lt;</span><span class="n">Policy</span><span class="o">&gt;</span><span class="w"> </span><span class="n">submit</span><span class="p">(</span><span class="n">Policy</span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">F</span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">Args</span><span class="o">&amp;&amp;</span><span class="p">...</span><span class="w"> </span><span class="n">args</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Chooses a resource using the policy <code class="docutils literal notranslate"><span class="pre">p</span></code> and
then calls the user function <code class="docutils literal notranslate"><span class="pre">f</span></code>, passing the unwrapped selection
and <code class="docutils literal notranslate"><span class="pre">args...</span></code> as the arguments. It also implements the necessary
calls to report execution information for policies that
require reporting.</p>
<p><code class="docutils literal notranslate"><span class="pre">submit</span></code> returns a <em>submission</em> object. Passing the <em>submission</em> object to the
<code class="docutils literal notranslate"><span class="pre">wait</span></code> function will block the calling thread until the work offloaded by the
submission is complete. When using SYCL queues, this behaves as if calling
<code class="docutils literal notranslate"><span class="pre">sycl::event::wait</span></code> on the SYCL event returned by the user function.</p>
<p>The following example demonstrates the use of the function <code class="docutils literal notranslate"><span class="pre">submit</span></code> and the
function <code class="docutils literal notranslate"><span class="pre">wait</span></code>. The use of <code class="docutils literal notranslate"><span class="pre">single_task</span></code> is for syntactic demonstration
purposes only; any valid command group or series of command groups can be
submitted to the selected queue.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;oneapi/dpl/dynamic_selection&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;sycl/sycl.hpp&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span>

<span class="k">namespace</span><span class="w"> </span><span class="nn">ex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nn">oneapi</span><span class="o">::</span><span class="nn">dpl</span><span class="o">::</span><span class="nn">experimental</span><span class="p">;</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">ex</span><span class="o">::</span><span class="n">round_robin_policy</span><span class="w"> </span><span class="n">p</span><span class="p">{</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">sycl</span><span class="o">::</span><span class="n">queue</span><span class="p">{</span><span class="w"> </span><span class="n">sycl</span><span class="o">::</span><span class="n">cpu_selector_v</span><span class="w"> </span><span class="p">},</span>
<span class="w">                              </span><span class="n">sycl</span><span class="o">::</span><span class="n">queue</span><span class="p">{</span><span class="w"> </span><span class="n">sycl</span><span class="o">::</span><span class="n">gpu_selector_v</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">};</span>

<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">done</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ex</span><span class="o">::</span><span class="n">submit</span><span class="p">(</span><span class="cm">/* policy object */</span><span class="w"> </span><span class="n">p</span><span class="p">,</span>
<span class="w">                           </span><span class="cm">/* user function */</span>
<span class="w">                           </span><span class="p">[](</span><span class="n">sycl</span><span class="o">::</span><span class="n">queue</span><span class="w"> </span><span class="n">q</span><span class="p">,</span><span class="w"> </span><span class="cm">/* any additional args... */</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                              </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;(j == &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;): submit to &quot;</span>
<span class="w">                                        </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="p">((</span><span class="n">q</span><span class="p">.</span><span class="n">get_device</span><span class="p">().</span><span class="n">is_gpu</span><span class="p">())</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s">&quot;gpu</span><span class="se">\n</span><span class="s">&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;cpu</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">                              </span><span class="k">auto</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">q</span><span class="p">.</span><span class="n">single_task</span><span class="p">([]()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="cm">/* do some work */</span><span class="w"> </span><span class="p">});</span>
<span class="w">                              </span><span class="k">return</span><span class="w"> </span><span class="n">e</span><span class="p">;</span><span class="w"> </span><span class="cm">/* MUST return sycl::event */</span>
<span class="w">                           </span><span class="p">},</span>
<span class="w">                           </span><span class="cm">/* any additional args... */</span><span class="w"> </span><span class="n">i</span><span class="p">);</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;(i == &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;): async work on main thread</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="n">ex</span><span class="o">::</span><span class="n">wait</span><span class="p">(</span><span class="n">done</span><span class="p">);</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;(i == &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;): submission done</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The output from this example is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span> <span class="n">submit</span> <span class="n">to</span> <span class="n">cpu</span>
<span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span> <span class="k">async</span> <span class="n">work</span> <span class="n">on</span> <span class="n">main</span> <span class="n">thread</span>
<span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span> <span class="n">submission</span> <span class="n">done</span>
<span class="p">(</span><span class="n">j</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span> <span class="n">submit</span> <span class="n">to</span> <span class="n">gpu</span>
<span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span> <span class="k">async</span> <span class="n">work</span> <span class="n">on</span> <span class="n">main</span> <span class="n">thread</span>
<span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span> <span class="n">submission</span> <span class="n">done</span>
<span class="p">(</span><span class="n">j</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span> <span class="n">submit</span> <span class="n">to</span> <span class="n">cpu</span>
<span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span> <span class="k">async</span> <span class="n">work</span> <span class="n">on</span> <span class="n">main</span> <span class="n">thread</span>
<span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span> <span class="n">submission</span> <span class="n">done</span>
<span class="p">(</span><span class="n">j</span> <span class="o">==</span> <span class="mi">3</span><span class="p">):</span> <span class="n">submit</span> <span class="n">to</span> <span class="n">gpu</span>
<span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="mi">3</span><span class="p">):</span> <span class="k">async</span> <span class="n">work</span> <span class="n">on</span> <span class="n">main</span> <span class="n">thread</span>
<span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="mi">3</span><span class="p">):</span> <span class="n">submission</span> <span class="n">done</span>
</pre></div>
</div>
</div>
<div class="section" id="submit-using-a-selection">
<h3>Submit Using a Selection<a class="headerlink" href="#submit-using-a-selection" title="Permalink to this headline">#</a></h3>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">namespace</span><span class="w"> </span><span class="nn">oneapi</span><span class="o">::</span><span class="nn">dpl</span><span class="o">::</span><span class="nn">experimental</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">Selection</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span><span class="w"> </span><span class="nc">F</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span><span class="p">...</span><span class="w"> </span><span class="n">Args</span><span class="o">&gt;</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">submit</span><span class="p">(</span><span class="n">Selection</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="n">F</span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">Args</span><span class="o">&amp;&amp;</span><span class="p">...</span><span class="w"> </span><span class="n">args</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Calls the user function <code class="docutils literal notranslate"><span class="pre">f</span></code>, passing the unwrapped selection <code class="docutils literal notranslate"><span class="pre">s</span></code> and <code class="docutils literal notranslate"><span class="pre">args...</span></code>
as the arguments. It also implements the necessary calls to report execution
information for policies that require reporting.</p>
<p><code class="docutils literal notranslate"><span class="pre">submit</span></code> returns a <em>submission</em> object. Passing the <em>submission</em> object to the
<code class="docutils literal notranslate"><span class="pre">wait</span></code> function will block the calling thread until the work offloaded by the
submission is complete. When using SYCL queues, this behaves as if calling
<code class="docutils literal notranslate"><span class="pre">sycl::event::wait</span></code> on the SYCL event returned by the user function.</p>
<p>The following example demonstrates the use of the function <code class="docutils literal notranslate"><span class="pre">submit</span></code> with an
object return by a call to select. The use of <code class="docutils literal notranslate"><span class="pre">single_task</span></code> is for
syntactic demonstration purposes only; any valid command group or series of
command groups can be submitted to the selected queue.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;oneapi/dpl/dynamic_selection&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;sycl/sycl.hpp&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span>

<span class="k">namespace</span><span class="w"> </span><span class="nn">ex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nn">oneapi</span><span class="o">::</span><span class="nn">dpl</span><span class="o">::</span><span class="nn">experimental</span><span class="p">;</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">ex</span><span class="o">::</span><span class="n">round_robin_policy</span><span class="w"> </span><span class="n">p</span><span class="p">{</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">sycl</span><span class="o">::</span><span class="n">queue</span><span class="p">{</span><span class="w"> </span><span class="n">sycl</span><span class="o">::</span><span class="n">cpu_selector_v</span><span class="w"> </span><span class="p">},</span>
<span class="w">                              </span><span class="n">sycl</span><span class="o">::</span><span class="n">queue</span><span class="p">{</span><span class="w"> </span><span class="n">sycl</span><span class="o">::</span><span class="n">gpu_selector_v</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">};</span>

<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ex</span><span class="o">::</span><span class="n">select</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">done</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ex</span><span class="o">::</span><span class="n">submit</span><span class="p">(</span><span class="cm">/* selection object */</span><span class="w"> </span><span class="n">s</span><span class="p">,</span>
<span class="w">                           </span><span class="cm">/* user function */</span>
<span class="w">                           </span><span class="p">[](</span><span class="n">sycl</span><span class="o">::</span><span class="n">queue</span><span class="w"> </span><span class="n">q</span><span class="p">,</span><span class="w"> </span><span class="cm">/* any additional args... */</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                              </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;(j == &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;): submit to &quot;</span>
<span class="w">                                        </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="p">((</span><span class="n">q</span><span class="p">.</span><span class="n">get_device</span><span class="p">().</span><span class="n">is_gpu</span><span class="p">())</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s">&quot;gpu</span><span class="se">\n</span><span class="s">&quot;</span><span class="w"> </span><span class="o">:</span><span class="w">  </span><span class="s">&quot;cpu</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">                              </span><span class="k">auto</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">q</span><span class="p">.</span><span class="n">single_task</span><span class="p">([]()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="cm">/* do some work */</span><span class="w"> </span><span class="p">});</span>
<span class="w">                              </span><span class="k">return</span><span class="w"> </span><span class="n">e</span><span class="p">;</span><span class="w"> </span><span class="cm">/* MUST return sycl::event */</span>
<span class="w">                           </span><span class="p">},</span>
<span class="w">                           </span><span class="cm">/* any additional args... */</span><span class="w"> </span><span class="n">i</span><span class="p">);</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;(i == &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;): async work on main thread</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="n">ex</span><span class="o">::</span><span class="n">wait</span><span class="p">(</span><span class="n">done</span><span class="p">);</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;(i == &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;): submission done</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The output from this example is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span> <span class="n">submit</span> <span class="n">to</span> <span class="n">cpu</span>
<span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span> <span class="k">async</span> <span class="n">work</span> <span class="n">on</span> <span class="n">main</span> <span class="n">thread</span>
<span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span> <span class="n">submission</span> <span class="n">done</span>
<span class="p">(</span><span class="n">j</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span> <span class="n">submit</span> <span class="n">to</span> <span class="n">gpu</span>
<span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span> <span class="k">async</span> <span class="n">work</span> <span class="n">on</span> <span class="n">main</span> <span class="n">thread</span>
<span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span> <span class="n">submission</span> <span class="n">done</span>
<span class="p">(</span><span class="n">j</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span> <span class="n">submit</span> <span class="n">to</span> <span class="n">cpu</span>
<span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span> <span class="k">async</span> <span class="n">work</span> <span class="n">on</span> <span class="n">main</span> <span class="n">thread</span>
<span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span> <span class="n">submission</span> <span class="n">done</span>
<span class="p">(</span><span class="n">j</span> <span class="o">==</span> <span class="mi">3</span><span class="p">):</span> <span class="n">submit</span> <span class="n">to</span> <span class="n">gpu</span>
<span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="mi">3</span><span class="p">):</span> <span class="k">async</span> <span class="n">work</span> <span class="n">on</span> <span class="n">main</span> <span class="n">thread</span>
<span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="mi">3</span><span class="p">):</span> <span class="n">submission</span> <span class="n">done</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="wait">
<h2>Wait<a class="headerlink" href="#wait" title="Permalink to this headline">#</a></h2>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">namespace</span><span class="w"> </span><span class="nn">oneapi</span><span class="o">::</span><span class="nn">dpl</span><span class="o">::</span><span class="nn">experimental</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">W</span><span class="o">&gt;</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">wait</span><span class="p">(</span><span class="n">W</span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">w</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The function <code class="docutils literal notranslate"><span class="pre">wait</span></code> blocks the calling thread until the work associated with
object <code class="docutils literal notranslate"><span class="pre">w</span></code> is complete. The object returned from
a call to <code class="docutils literal notranslate"><span class="pre">submit</span></code> can be passed to this function to wait for the completion of a specific submission or the
object returned from a call to <code class="docutils literal notranslate"><span class="pre">get_submission_group</span></code> to wait for all submissions
made using a policy.  Example code that demonstrates waiting for a specific
submission can be seen in the section for <code class="docutils literal notranslate"><span class="pre">submit</span></code>.</p>
<p>The following is an example that demonstrates waiting for all submissions by passing
the object returned by <code class="docutils literal notranslate"><span class="pre">get_submission_group()</span></code> to <code class="docutils literal notranslate"><span class="pre">wait</span></code>:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;oneapi/dpl/dynamic_selection&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;sycl/sycl.hpp&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span>

<span class="k">namespace</span><span class="w"> </span><span class="nn">ex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nn">oneapi</span><span class="o">::</span><span class="nn">dpl</span><span class="o">::</span><span class="nn">experimental</span><span class="p">;</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">ex</span><span class="o">::</span><span class="n">round_robin_policy</span><span class="w"> </span><span class="n">p</span><span class="p">{</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">sycl</span><span class="o">::</span><span class="n">queue</span><span class="p">{</span><span class="w"> </span><span class="n">sycl</span><span class="o">::</span><span class="n">cpu_selector_v</span><span class="w"> </span><span class="p">},</span>
<span class="w">                              </span><span class="n">sycl</span><span class="o">::</span><span class="n">queue</span><span class="p">{</span><span class="w"> </span><span class="n">sycl</span><span class="o">::</span><span class="n">gpu_selector_v</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">};</span>

<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">done</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ex</span><span class="o">::</span><span class="n">submit</span><span class="p">(</span><span class="cm">/* policy object */</span><span class="w"> </span><span class="n">p</span><span class="p">,</span>
<span class="w">                           </span><span class="cm">/* user function */</span>
<span class="w">                           </span><span class="p">[](</span><span class="n">sycl</span><span class="o">::</span><span class="n">queue</span><span class="w"> </span><span class="n">q</span><span class="p">,</span><span class="w"> </span><span class="cm">/* any additional args... */</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                              </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;(j == &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;): submit to &quot;</span>
<span class="w">                                        </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="p">((</span><span class="n">q</span><span class="p">.</span><span class="n">get_device</span><span class="p">().</span><span class="n">is_gpu</span><span class="p">())</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s">&quot;gpu</span><span class="se">\n</span><span class="s">&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;cpu</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">                              </span><span class="k">auto</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">q</span><span class="p">.</span><span class="n">single_task</span><span class="p">([]()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="cm">/* do some work */</span><span class="w"> </span><span class="p">});</span>
<span class="w">                              </span><span class="k">return</span><span class="w"> </span><span class="n">e</span><span class="p">;</span><span class="w"> </span><span class="cm">/* MUST return sycl::event */</span>
<span class="w">                           </span><span class="p">},</span>
<span class="w">                           </span><span class="cm">/* any additional args... */</span><span class="w"> </span><span class="n">i</span><span class="p">);</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;(i == &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;): async work on main thread</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="n">ex</span><span class="o">::</span><span class="n">wait</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">get_submission_group</span><span class="p">());</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;done waiting for all submissions</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The output from this example is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span> <span class="n">submit</span> <span class="n">to</span> <span class="n">cpu</span>
<span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span> <span class="k">async</span> <span class="n">work</span> <span class="n">on</span> <span class="n">main</span> <span class="n">thread</span>
<span class="p">(</span><span class="n">j</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span> <span class="n">submit</span> <span class="n">to</span> <span class="n">gpu</span>
<span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span> <span class="k">async</span> <span class="n">work</span> <span class="n">on</span> <span class="n">main</span> <span class="n">thread</span>
<span class="p">(</span><span class="n">j</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span> <span class="n">submit</span> <span class="n">to</span> <span class="n">cpu</span>
<span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span> <span class="k">async</span> <span class="n">work</span> <span class="n">on</span> <span class="n">main</span> <span class="n">thread</span>
<span class="p">(</span><span class="n">j</span> <span class="o">==</span> <span class="mi">3</span><span class="p">):</span> <span class="n">submit</span> <span class="n">to</span> <span class="n">gpu</span>
<span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="mi">3</span><span class="p">):</span> <span class="k">async</span> <span class="n">work</span> <span class="n">on</span> <span class="n">main</span> <span class="n">thread</span>
<span class="n">done</span> <span class="n">waiting</span> <span class="k">for</span> <span class="nb">all</span> <span class="n">submissions</span>
</pre></div>
</div>
</div>
<div class="section" id="submit-and-wait">
<h2>Submit and Wait<a class="headerlink" href="#submit-and-wait" title="Permalink to this headline">#</a></h2>
<p>Just like <code class="docutils literal notranslate"><span class="pre">submit</span></code>, <code class="docutils literal notranslate"><span class="pre">submit_and_wait</span></code> has two function signatures:</p>
<ol class="arabic simple">
<li><p>the first argument is a <em>policy</em> object.</p></li>
<li><p>the first argument is a <em>selection</em> object that was returned by a previous call to <code class="docutils literal notranslate"><span class="pre">select</span></code>.</p></li>
</ol>
<p>The difference between <code class="docutils literal notranslate"><span class="pre">submit_and_wait</span></code> and <code class="docutils literal notranslate"><span class="pre">submit</span></code> is that
<code class="docutils literal notranslate"><span class="pre">submit_and_wait</span></code> blocks the calling thread until the work associated
with the submission is complete. This behavior is essentially a short-cut
for calling <code class="docutils literal notranslate"><span class="pre">wait</span></code> on the object returned by a call to <code class="docutils literal notranslate"><span class="pre">submit</span></code>.</p>
<div class="section" id="submit-and-wait-using-a-policy">
<h3>Submit and Wait Using a Policy<a class="headerlink" href="#submit-and-wait-using-a-policy" title="Permalink to this headline">#</a></h3>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">namespace</span><span class="w"> </span><span class="nn">oneapi</span><span class="o">::</span><span class="nn">dpl</span><span class="o">::</span><span class="nn">experimental</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">Policy</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span><span class="w"> </span><span class="nc">F</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span><span class="p">...</span><span class="w"> </span><span class="n">Args</span><span class="o">&gt;</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">submit_and_wait</span><span class="p">(</span><span class="n">Policy</span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">F</span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">Args</span><span class="o">&amp;&amp;</span><span class="p">...</span><span class="w"> </span><span class="n">args</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Chooses a resource using the policy <code class="docutils literal notranslate"><span class="pre">p</span></code> and
then calls the user function <code class="docutils literal notranslate"><span class="pre">f</span></code>, passing the unwrapped selection
and <code class="docutils literal notranslate"><span class="pre">args...</span></code> as the arguments. It implements the necessary
calls to report execution information for policies that
require reporting. This function blocks the calling thread until
the user function and any work that it submits to the selected resource
are complete.</p>
<p>The following example demonstrates the use of the function <code class="docutils literal notranslate"><span class="pre">submit_and_wait</span></code>.
The use of <code class="docutils literal notranslate"><span class="pre">single_task</span></code> is for syntactic demonstration
purposes only; any valid command group or series of command groups can be
submitted to the selected queue.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;oneapi/dpl/dynamic_selection&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;sycl/sycl.hpp&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span>

<span class="k">namespace</span><span class="w"> </span><span class="nn">ex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nn">oneapi</span><span class="o">::</span><span class="nn">dpl</span><span class="o">::</span><span class="nn">experimental</span><span class="p">;</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">ex</span><span class="o">::</span><span class="n">round_robin_policy</span><span class="w"> </span><span class="n">p</span><span class="p">{</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">sycl</span><span class="o">::</span><span class="n">queue</span><span class="p">{</span><span class="w"> </span><span class="n">sycl</span><span class="o">::</span><span class="n">cpu_selector_v</span><span class="w"> </span><span class="p">},</span>
<span class="w">                              </span><span class="n">sycl</span><span class="o">::</span><span class="n">queue</span><span class="p">{</span><span class="w"> </span><span class="n">sycl</span><span class="o">::</span><span class="n">gpu_selector_v</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">};</span>

<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">ex</span><span class="o">::</span><span class="n">submit_and_wait</span><span class="p">(</span><span class="cm">/* policy object */</span><span class="w"> </span><span class="n">p</span><span class="p">,</span>
<span class="w">                        </span><span class="cm">/* user function */</span>
<span class="w">                        </span><span class="p">[](</span><span class="n">sycl</span><span class="o">::</span><span class="n">queue</span><span class="w"> </span><span class="n">q</span><span class="p">,</span><span class="w"> </span><span class="cm">/* any additional args... */</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                           </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;(j == &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;): submit to &quot;</span>
<span class="w">                                     </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="p">((</span><span class="n">q</span><span class="p">.</span><span class="n">get_device</span><span class="p">().</span><span class="n">is_gpu</span><span class="p">())</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s">&quot;gpu</span><span class="se">\n</span><span class="s">&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;cpu</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">                           </span><span class="k">auto</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">q</span><span class="p">.</span><span class="n">single_task</span><span class="p">([]()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="cm">/* do some work */</span><span class="w"> </span><span class="p">});</span>
<span class="w">                           </span><span class="k">return</span><span class="w"> </span><span class="n">e</span><span class="p">;</span><span class="w"> </span><span class="cm">/* MUST return sycl::event */</span>
<span class="w">                        </span><span class="p">},</span>
<span class="w">                        </span><span class="cm">/* any additional args... */</span><span class="w"> </span><span class="n">i</span><span class="p">);</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;(i == &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;): submission done</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The output from this example is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span> <span class="n">submit</span> <span class="n">to</span> <span class="n">cpu</span>
<span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span> <span class="n">submission</span> <span class="n">done</span>
<span class="p">(</span><span class="n">j</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span> <span class="n">submit</span> <span class="n">to</span> <span class="n">gpu</span>
<span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span> <span class="n">submission</span> <span class="n">done</span>
<span class="p">(</span><span class="n">j</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span> <span class="n">submit</span> <span class="n">to</span> <span class="n">cpu</span>
<span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span> <span class="n">submission</span> <span class="n">done</span>
<span class="p">(</span><span class="n">j</span> <span class="o">==</span> <span class="mi">3</span><span class="p">):</span> <span class="n">submit</span> <span class="n">to</span> <span class="n">gpu</span>
<span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="mi">3</span><span class="p">):</span> <span class="n">submission</span> <span class="n">done</span>
</pre></div>
</div>
</div>
<div class="section" id="submit-and-wait-using-a-selection">
<h3>Submit and Wait Using a Selection<a class="headerlink" href="#submit-and-wait-using-a-selection" title="Permalink to this headline">#</a></h3>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">namespace</span><span class="w"> </span><span class="nn">oneapi</span><span class="o">::</span><span class="nn">dpl</span><span class="o">::</span><span class="nn">experimental</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">Selection</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span><span class="w"> </span><span class="nc">F</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span><span class="p">...</span><span class="w"> </span><span class="n">Args</span><span class="o">&gt;</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">submit_and_wait</span><span class="p">(</span><span class="n">Selection</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="n">F</span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">Args</span><span class="o">&amp;&amp;</span><span class="p">...</span><span class="w"> </span><span class="n">args</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Calls the user function <code class="docutils literal notranslate"><span class="pre">f</span></code>, passing the unwrapped selection <code class="docutils literal notranslate"><span class="pre">s</span></code> and <code class="docutils literal notranslate"><span class="pre">args...</span></code>
as the arguments. It also implements the necessary calls to report execution
information for policies that require reporting.</p>
<p>This function blocks the calling thread until
the user function and any work that it submits to the resource
are complete.</p>
<p>The following example demonstrates the use of the function <code class="docutils literal notranslate"><span class="pre">submit_and_wait</span></code>.
The use of <code class="docutils literal notranslate"><span class="pre">single_task</span></code> is for syntactic demonstration
purposes only; any valid command group or series of command groups can be
submitted to the selected queue.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;oneapi/dpl/dynamic_selection&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;sycl/sycl.hpp&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span>

<span class="k">namespace</span><span class="w"> </span><span class="nn">ex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nn">oneapi</span><span class="o">::</span><span class="nn">dpl</span><span class="o">::</span><span class="nn">experimental</span><span class="p">;</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">ex</span><span class="o">::</span><span class="n">round_robin_policy</span><span class="w"> </span><span class="n">p</span><span class="p">{</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">sycl</span><span class="o">::</span><span class="n">queue</span><span class="p">{</span><span class="w"> </span><span class="n">sycl</span><span class="o">::</span><span class="n">cpu_selector_v</span><span class="w"> </span><span class="p">},</span>
<span class="w">                              </span><span class="n">sycl</span><span class="o">::</span><span class="n">queue</span><span class="p">{</span><span class="w"> </span><span class="n">sycl</span><span class="o">::</span><span class="n">gpu_selector_v</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">};</span>

<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ex</span><span class="o">::</span><span class="n">select</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>
<span class="w">    </span><span class="n">ex</span><span class="o">::</span><span class="n">submit_and_wait</span><span class="p">(</span><span class="cm">/* selection object */</span><span class="w"> </span><span class="n">s</span><span class="p">,</span>
<span class="w">                        </span><span class="cm">/* user function */</span>
<span class="w">                        </span><span class="p">[](</span><span class="n">sycl</span><span class="o">::</span><span class="n">queue</span><span class="w"> </span><span class="n">q</span><span class="p">,</span><span class="w"> </span><span class="cm">/* any additional args... */</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                           </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;(j == &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;): submit to &quot;</span>
<span class="w">                                     </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="p">((</span><span class="n">q</span><span class="p">.</span><span class="n">get_device</span><span class="p">().</span><span class="n">is_gpu</span><span class="p">())</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s">&quot;gpu</span><span class="se">\n</span><span class="s">&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;cpu</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">                           </span><span class="k">auto</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">q</span><span class="p">.</span><span class="n">single_task</span><span class="p">([]()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="cm">/* do some work */</span><span class="w"> </span><span class="p">});</span>
<span class="w">                           </span><span class="k">return</span><span class="w"> </span><span class="n">e</span><span class="p">;</span><span class="w"> </span><span class="cm">/* MUST return sycl::event */</span>
<span class="w">                        </span><span class="p">},</span>
<span class="w">                        </span><span class="cm">/* any additional args... */</span><span class="w"> </span><span class="n">i</span><span class="p">);</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;(i == &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;): submission done</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The output from this example is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span> <span class="n">submit</span> <span class="n">to</span> <span class="n">cpu</span>
<span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span> <span class="n">submission</span> <span class="n">done</span>
<span class="p">(</span><span class="n">j</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span> <span class="n">submit</span> <span class="n">to</span> <span class="n">gpu</span>
<span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span> <span class="n">submission</span> <span class="n">done</span>
<span class="p">(</span><span class="n">j</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span> <span class="n">submit</span> <span class="n">to</span> <span class="n">cpu</span>
<span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span> <span class="n">submission</span> <span class="n">done</span>
<span class="p">(</span><span class="n">j</span> <span class="o">==</span> <span class="mi">3</span><span class="p">):</span> <span class="n">submit</span> <span class="n">to</span> <span class="n">gpu</span>
<span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="mi">3</span><span class="p">):</span> <span class="n">submission</span> <span class="n">done</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="policy-queries">
<h2>Policy Queries<a class="headerlink" href="#policy-queries" title="Permalink to this headline">#</a></h2>
<div class="section" id="getting-the-resource-options">
<h3>Getting the Resource Options<a class="headerlink" href="#getting-the-resource-options" title="Permalink to this headline">#</a></h3>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">namespace</span><span class="w"> </span><span class="nn">oneapi</span><span class="o">::</span><span class="nn">dpl</span><span class="o">::</span><span class="nn">experimental</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">Policy</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span><span class="p">...</span><span class="w"> </span><span class="n">Args</span><span class="o">&gt;</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">resource_t</span><span class="o">&lt;</span><span class="n">Policy</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">get_resources</span><span class="p">(</span><span class="n">Policy</span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Returns a <code class="docutils literal notranslate"><span class="pre">std::vector</span></code> that contains the resources that a policy
selects from. The following example demonstrates the use of the function
<code class="docutils literal notranslate"><span class="pre">get_resources</span></code>.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;oneapi/dpl/dynamic_selection&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;sycl/sycl.hpp&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span>

<span class="k">namespace</span><span class="w"> </span><span class="nn">ex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nn">oneapi</span><span class="o">::</span><span class="nn">dpl</span><span class="o">::</span><span class="nn">experimental</span><span class="p">;</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">ex</span><span class="o">::</span><span class="n">round_robin_policy</span><span class="w"> </span><span class="n">p_explicit</span><span class="p">{</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">sycl</span><span class="o">::</span><span class="n">queue</span><span class="p">{</span><span class="w"> </span><span class="n">sycl</span><span class="o">::</span><span class="n">cpu_selector_v</span><span class="w"> </span><span class="p">},</span>
<span class="w">                                       </span><span class="n">sycl</span><span class="o">::</span><span class="n">queue</span><span class="p">{</span><span class="w"> </span><span class="n">sycl</span><span class="o">::</span><span class="n">gpu_selector_v</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">};</span>

<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Resources in explicitly set policy</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">auto</span><span class="o">&amp;</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p_explicit</span><span class="p">.</span><span class="n">get_resources</span><span class="p">())</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;queue is &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="p">((</span><span class="n">q</span><span class="p">.</span><span class="n">get_device</span><span class="p">().</span><span class="n">is_gpu</span><span class="p">())</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s">&quot;gpu</span><span class="se">\n</span><span class="s">&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;cpu</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>

<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">Resources in default policy</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="w">  </span><span class="n">ex</span><span class="o">::</span><span class="n">round_robin_policy</span><span class="w"> </span><span class="n">p_default</span><span class="p">;</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">auto</span><span class="o">&amp;</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">p_default</span><span class="p">.</span><span class="n">get_resources</span><span class="p">())</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;queue is &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="p">((</span><span class="n">q</span><span class="p">.</span><span class="n">get_device</span><span class="p">().</span><span class="n">is_gpu</span><span class="p">())</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s">&quot;gpu</span><span class="se">\n</span><span class="s">&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;not-gpu</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The output from this example on a test machine is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Resources</span> <span class="ow">in</span> <span class="n">explicitly</span> <span class="nb">set</span> <span class="n">policy</span>
<span class="n">queue</span> <span class="ow">is</span> <span class="n">cpu</span>
<span class="n">queue</span> <span class="ow">is</span> <span class="n">gpu</span>

<span class="n">Resources</span> <span class="ow">in</span> <span class="n">default</span> <span class="n">policy</span>
<span class="n">queue</span> <span class="ow">is</span> <span class="ow">not</span><span class="o">-</span><span class="n">gpu</span>
<span class="n">queue</span> <span class="ow">is</span> <span class="ow">not</span><span class="o">-</span><span class="n">gpu</span>
<span class="n">queue</span> <span class="ow">is</span> <span class="n">gpu</span>
<span class="n">queue</span> <span class="ow">is</span> <span class="n">gpu</span>
</pre></div>
</div>
<p>When passing queues to the policy, the results show that the policy uses those
resources, a single CPU queue and a single GPU queue.</p>
<p>The platform used to run this example has two GPU drivers installed,
as well as an FPGA emulator. When no resources are explicitly provided to the
policy constructor, the results show two non-GPU devices (the CPU and the FPGA
emulator) and two drivers for the GPU.</p>
</div>
<div class="section" id="getting-the-group-of-submissions">
<h3>Getting the Group of Submissions<a class="headerlink" href="#getting-the-group-of-submissions" title="Permalink to this headline">#</a></h3>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">namespace</span><span class="w"> </span><span class="nn">oneapi</span><span class="o">::</span><span class="nn">dpl</span><span class="o">::</span><span class="nn">experimental</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">Policy</span><span class="o">&gt;</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">get_submission_group</span><span class="p">(</span><span class="n">Policy</span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">p</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Returns an object that can be passed to <code class="docutils literal notranslate"><span class="pre">wait</span></code> to block the main
thread until all work submitted to queues managed by the policy are
complete.</p>
<p>An example that demonstrates the use of this function can be found in
the section that describes the <code class="docutils literal notranslate"><span class="pre">submit</span></code> function.</p>
</div>
</div>
<div class="section" id="report">
<h2>Report<a class="headerlink" href="#report" title="Permalink to this headline">#</a></h2>
<div class="section" id="reporting-events-with-no-associated-values">
<h3>Reporting Events with No Associated Values<a class="headerlink" href="#reporting-events-with-no-associated-values" title="Permalink to this headline">#</a></h3>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">namespace</span><span class="w"> </span><span class="nn">oneapi</span><span class="o">::</span><span class="nn">dpl</span><span class="o">::</span><span class="nn">experimental</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">Selection</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span><span class="w"> </span><span class="nc">Info</span><span class="o">&gt;</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">report</span><span class="p">(</span><span class="n">Selection</span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Info</span><span class="o">&amp;</span><span class="w"> </span><span class="n">i</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Reports an execution info event to the policy. What events must reported
is policy dependent. No reporting is necessary when using the <code class="docutils literal notranslate"><span class="pre">submit</span></code> or
<code class="docutils literal notranslate"><span class="pre">submit_and_wait</span></code> functions, since these functions contain all necessary
instrumentation.</p>
<p>An example that uses reporting for the <code class="docutils literal notranslate"><span class="pre">dynamic_load_policy</span></code> is shown
below. This reporting is only necessary because <code class="docutils literal notranslate"><span class="pre">select</span></code> is used
but the resource is not passed to a <code class="docutils literal notranslate"><span class="pre">submit</span></code> or <code class="docutils literal notranslate"><span class="pre">submit_and_wait</span></code> function but
is instead used directly. The use of <code class="docutils literal notranslate"><span class="pre">single_task</span></code> is for syntactic demonstration
purposes only; any valid command group or series of command groups can be
submitted to the selected queue.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;oneapi/dpl/dynamic_selection&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;chrono&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;sycl/sycl.hpp&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span>

<span class="k">namespace</span><span class="w"> </span><span class="nn">ex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nn">oneapi</span><span class="o">::</span><span class="nn">dpl</span><span class="o">::</span><span class="nn">experimental</span><span class="p">;</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">ex</span><span class="o">::</span><span class="n">dynamic_load_policy</span><span class="w"> </span><span class="n">p</span><span class="p">{</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">sycl</span><span class="o">::</span><span class="n">queue</span><span class="p">{</span><span class="w"> </span><span class="n">sycl</span><span class="o">::</span><span class="n">cpu_selector_v</span><span class="w"> </span><span class="p">},</span>
<span class="w">                               </span><span class="n">sycl</span><span class="o">::</span><span class="n">queue</span><span class="p">{</span><span class="w"> </span><span class="n">sycl</span><span class="o">::</span><span class="n">gpu_selector_v</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">};</span>

<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">selection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ex</span><span class="o">::</span><span class="n">select</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ex</span><span class="o">::</span><span class="n">unwrap</span><span class="p">(</span><span class="n">selection</span><span class="p">);</span>

<span class="w">    </span><span class="n">ex</span><span class="o">::</span><span class="n">report</span><span class="p">(</span><span class="n">selection</span><span class="p">,</span><span class="w"> </span><span class="n">ex</span><span class="o">::</span><span class="n">execution_info</span><span class="o">::</span><span class="n">task_submission</span><span class="p">);</span>
<span class="w">    </span><span class="n">q</span><span class="p">.</span><span class="n">single_task</span><span class="p">([]()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="cm">/* do work */</span><span class="w"> </span><span class="p">}).</span><span class="n">wait</span><span class="p">();</span>
<span class="w">    </span><span class="n">ex</span><span class="o">::</span><span class="n">report</span><span class="p">(</span><span class="n">selection</span><span class="p">,</span><span class="w"> </span><span class="n">ex</span><span class="o">::</span><span class="n">execution_info</span><span class="o">::</span><span class="n">task_completion</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="reporting-events-with-associated-values">
<h3>Reporting Events with Associated Values<a class="headerlink" href="#reporting-events-with-associated-values" title="Permalink to this headline">#</a></h3>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">namespace</span><span class="w"> </span><span class="nn">oneapi</span><span class="o">::</span><span class="nn">dpl</span><span class="o">::</span><span class="nn">experimental</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">Selection</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span><span class="w"> </span><span class="nc">Info</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span><span class="w"> </span><span class="nc">Value</span><span class="o">&gt;</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">report</span><span class="p">(</span><span class="n">Selection</span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Info</span><span class="o">&amp;</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Value</span><span class="o">&amp;</span><span class="w"> </span><span class="n">v</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Reports an execution info event along with an associated value to the policy.
What events must reported is policy dependent. No reporting is necessary
if using the <code class="docutils literal notranslate"><span class="pre">submit</span></code> or <code class="docutils literal notranslate"><span class="pre">submit_and_wait</span></code> functions, since these functions contain
all necessary instrumentation.</p>
<p>An example that uses reporting for the <code class="docutils literal notranslate"><span class="pre">auto_tune_policy</span></code> is shown
below. This reporting is only necessary in this case because <code class="docutils literal notranslate"><span class="pre">select</span></code> is used
but the resource is not passed to a <code class="docutils literal notranslate"><span class="pre">submit</span></code> or <code class="docutils literal notranslate"><span class="pre">submit_and_wait</span></code> function but
is instead used directly. The use of <code class="docutils literal notranslate"><span class="pre">single_task</span></code> is for syntactic demonstration
purposes only; any valid command group or series of command groups can be
submitted to the selected queue.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;oneapi/dpl/dynamic_selection&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;chrono&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;sycl/sycl.hpp&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span>

<span class="k">namespace</span><span class="w"> </span><span class="nn">ex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nn">oneapi</span><span class="o">::</span><span class="nn">dpl</span><span class="o">::</span><span class="nn">experimental</span><span class="p">;</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">ex</span><span class="o">::</span><span class="n">auto_tune_policy</span><span class="w"> </span><span class="n">p</span><span class="p">{</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">sycl</span><span class="o">::</span><span class="n">queue</span><span class="p">{</span><span class="w"> </span><span class="n">sycl</span><span class="o">::</span><span class="n">cpu_selector_v</span><span class="w"> </span><span class="p">},</span>
<span class="w">                            </span><span class="n">sycl</span><span class="o">::</span><span class="n">queue</span><span class="p">{</span><span class="w"> </span><span class="n">sycl</span><span class="o">::</span><span class="n">gpu_selector_v</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">};</span>

<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]()</span><span class="w"> </span><span class="p">{};</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">selection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ex</span><span class="o">::</span><span class="n">select</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="p">);</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ex</span><span class="o">::</span><span class="n">unwrap</span><span class="p">(</span><span class="n">selection</span><span class="p">);</span>

<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">chrono</span><span class="o">::</span><span class="n">steady_clock</span><span class="o">::</span><span class="n">now</span><span class="p">();</span>
<span class="w">    </span><span class="n">q</span><span class="p">.</span><span class="n">single_task</span><span class="p">(</span><span class="n">f</span><span class="p">).</span><span class="n">wait</span><span class="p">();</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">after</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">chrono</span><span class="o">::</span><span class="n">steady_clock</span><span class="o">::</span><span class="n">now</span><span class="p">();</span>
<span class="w">    </span><span class="n">ex</span><span class="o">::</span><span class="n">report</span><span class="p">(</span><span class="n">selection</span><span class="p">,</span><span class="w"> </span><span class="n">ex</span><span class="o">::</span><span class="n">execution_info</span><span class="o">::</span><span class="n">task_time</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">after</span><span class="o">-</span><span class="n">before</span><span class="p">).</span><span class="n">count</span><span class="p">());</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</div>


                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="../dynamic_selection_api_main.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Dynamic Selection API</p>
      </div>
    </a>
    <a class="right-next"
       href="policies.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Policies</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#select">Select</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#submit">Submit</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#submit-using-a-policy">Submit Using a Policy</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#submit-using-a-selection">Submit Using a Selection</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#wait">Wait</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#submit-and-wait">Submit and Wait</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#submit-and-wait-using-a-policy">Submit and Wait Using a Policy</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#submit-and-wait-using-a-selection">Submit and Wait Using a Selection</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#policy-queries">Policy Queries</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-the-resource-options">Getting the Resource Options</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-the-group-of-submissions">Getting the Group of Submissions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#report">Report</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reporting-events-with-no-associated-values">Reporting Events with No Associated Values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reporting-events-with-associated-values">Reporting Events with Associated Values</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Intel
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright Intel Corporation.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <p align="right"><a data-cookie-notice="true" href="https://www.intel.com/content/www/us/en/privacy/intel-cookie-notice.html">Cookies</a></p>
</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>