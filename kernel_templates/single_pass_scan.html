

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Inclusive Scan &#8212; oneDPL Documentation 2022.6.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'kernel_templates/single_pass_scan';</script>
    <link rel="shortcut icon" href="../_static/favicons.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Macros" href="../macros.html" />
    <link rel="prev" title="Radix Sort" href="esimd/radix_sort.html" />

    <script defer type="text/javascript" src="https://www.intel.com/content/dam/www/global/wap/performance-config.js" ></script>
    <script type="text/javascript">
        // Configure TMS settings
        var wapLocalCode = 'us-en'; // Dynamically set per localized site, see mapping table for values
        var wapSection = "oneapi-dpl"; // WAP team will give you a unique section for your site
        // Load TMS
        if(document.location.href.includes("oneapi-src.github.io")){
        (function () {
        var url = 'https://www.intel.com/content/dam/www/global/wap/tms-loader.js'; // WAP file URL
        var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true; po.src = url;
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
        })();
        }
    </script>
    <link href="../_static/style.css" rel="stylesheet" type="text/css">



  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/oneAPI-rgb-rev-100.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/oneAPI-rgb-rev-100.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Get Started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../introduction/release_notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction/onedpl_gsg.html">Get Started with the oneAPI DPC++ Library</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Library Guide</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">oneAPI DPC++ Library Introduction</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../parallel_api_main.html">Parallel API</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../parallel_api/execution_policies.html">Execution Policies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../parallel_api/iterators.html">Iterators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../parallel_api/async_api.html">Asynchronous API Algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../parallel_api/range_based_api.html">Range-Based API Algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../parallel_api/additional_algorithms.html">Additional Algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../parallel_api/pass_data_algorithms.html">Pass Data to Algorithms</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api_for_sycl_kernels_main.html">API for the SYCL* Kernels</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../api_for_sycl_kernels/random.html">Random Number Generators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_for_sycl_kernels/tested_standard_cpp_api.html">Tested Standard C++ APIs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_for_sycl_kernels/utility_function_object_classes.html">Utility Function Object Classes</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../dynamic_selection_api_main.html">Dynamic Selection API</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../dynamic_selection_api/functions.html">Functions</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../dynamic_selection_api/policies.html">Policies</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../dynamic_selection_api/fixed_resource_policy.html">Fixed-Resource Policy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dynamic_selection_api/round_robin_policy.html">Round-Robin Policy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dynamic_selection_api/dynamic_load_policy.html">Dynamic Load Policy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dynamic_selection_api/auto_tune_policy.html">Auto-Tune Policy</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../kernel_templates_main.html">Kernel Templates API</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="kernel_configuration.html">Kernel Configuration</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="esimd_main.html">ESIMD-Based Kernel Templates</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="esimd/radix_sort.html">Radix Sort</a></li>
</ul>
</li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Inclusive Scan</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../macros.html">Macros</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cmake_support.html">CMake Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../oneDPL_2022.0_changes.html">oneDPL 2022 Breaking Changes</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Notices and Disclaimers</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../notices_disclaimers.html">Notices and Disclaimers</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/oneapi-src/oneDPL/edit/main/documentation/library_guide/kernel_templates/single_pass_scan.rst" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/oneapi-src/oneDPL/issues/new?title=Issue%20on%20page%20%2Fkernel_templates/single_pass_scan.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/kernel_templates/single_pass_scan.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Inclusive Scan</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#inclusive-scan-function-template">inclusive_scan Function Template</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#parameters">Parameters</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#return-value">Return Value</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#usage-examples">Usage Examples</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inclusive-scan-example">inclusive_scan Example</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#memory-requirements">Memory Requirements</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#global-memory-requirements">Global Memory Requirements</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#local-memory-requirements">Local Memory Requirements</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#recommended-settings-for-best-performance">Recommended Settings for Best Performance</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <div class="section" id="inclusive-scan">
<h1>Inclusive Scan<a class="headerlink" href="#inclusive-scan" title="Permalink to this headline">#</a></h1>
<div class="section" id="inclusive-scan-function-template">
<h2>inclusive_scan Function Template<a class="headerlink" href="#inclusive-scan-function-template" title="Permalink to this headline">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">inclusive_scan</span></code> function computes the inclusive prefix sum using a given binary operation.
The function implements a single-pass algorithm, where each input element is read exactly once from
global memory and each output element is written to exactly once in global memory. This function
is an implementation of the Decoupled Look-back <a class="footnote-reference brackets" href="#fnote1" id="id1">1</a> scan algorithm.</p>
<p>The algorithm is designed to be compatible with a variety of devices that provide at least parallel
forward progress guarantees between work-groups, due to cross-work-group communication. Additionally, it
requires support for device USM (Unified Shared Memory). It has been verified to be compatible
with <a class="reference external" href="https://www.intel.com/content/www/us/en/products/details/discrete-gpus/data-center-gpu/max-series/products.html">Intel® Data Center GPU Max Series</a>.</p>
<p>A synopsis of the <code class="docutils literal notranslate"><span class="pre">inclusive_scan</span></code> function is provided below:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// defined in &lt;oneapi/dpl/experimental/kernel_templates&gt;</span>

<span class="k">namespace</span><span class="w"> </span><span class="nn">oneapi</span><span class="o">::</span><span class="nn">dpl</span><span class="o">::</span><span class="nn">experimental</span><span class="o">::</span><span class="nn">kt</span><span class="o">::</span><span class="nn">gpu</span><span class="w"> </span><span class="p">{</span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">InIterator</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span><span class="w"> </span><span class="nc">OutIterator</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span><span class="w"> </span><span class="nc">BinaryOp</span><span class="o">&gt;</span>
<span class="n">sycl</span><span class="o">::</span><span class="n">event</span>
<span class="n">inclusive_scan</span><span class="w"> </span><span class="p">(</span><span class="n">sycl</span><span class="o">::</span><span class="n">queue</span><span class="w"> </span><span class="n">q</span><span class="p">,</span><span class="w"> </span><span class="n">InIterator</span><span class="w"> </span><span class="n">in_begin</span><span class="p">,</span><span class="w"> </span><span class="n">InIterator</span><span class="w"> </span><span class="n">in_end</span><span class="p">,</span><span class="w"> </span><span class="n">OutIterator</span><span class="w"> </span><span class="n">out_begin</span><span class="p">,</span>
<span class="w">                </span><span class="n">BinaryOp</span><span class="w"> </span><span class="n">binary_op</span><span class="p">,</span><span class="w"> </span><span class="n">KernelParam</span><span class="w"> </span><span class="n">param</span><span class="p">);</span><span class="w"> </span><span class="c1">// (1)</span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">InRng</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span><span class="w"> </span><span class="nc">OutRng</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span><span class="w"> </span><span class="nc">BinaryOp</span><span class="o">&gt;</span>
<span class="n">sycl</span><span class="o">::</span><span class="n">event</span>
<span class="n">inclusive_scan</span><span class="w"> </span><span class="p">(</span><span class="n">sycl</span><span class="o">::</span><span class="n">queue</span><span class="w"> </span><span class="n">q</span><span class="p">,</span><span class="w"> </span><span class="n">InRng</span><span class="w"> </span><span class="n">in_rng</span><span class="p">,</span><span class="w"> </span><span class="n">OutRng</span><span class="w"> </span><span class="n">out_rng</span><span class="p">,</span><span class="w"> </span><span class="n">BinaryOp</span><span class="w"> </span><span class="n">binary_op</span><span class="p">,</span>
<span class="w">                </span><span class="n">KernelParam</span><span class="w"> </span><span class="n">param</span><span class="p">)</span><span class="w"> </span><span class="c1">// (2)</span>

<span class="p">}</span>
</pre></div>
</div>
<div class="section" id="parameters">
<h3>Parameters<a class="headerlink" href="#parameters" title="Permalink to this headline">#</a></h3>
<table class="table">
<colgroup>
<col style="width: 41%" />
<col style="width: 59%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">q</span></code></p></td>
<td><p>The SYCL* queue where kernels are submitted.</p></td>
</tr>
<tr class="row-odd"><td><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">in_begin</span></code>, <code class="docutils literal notranslate"><span class="pre">in_end</span></code>, <code class="docutils literal notranslate"><span class="pre">out_begin</span></code> (1),</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">in_rng</span></code>, <code class="docutils literal notranslate"><span class="pre">out_rng</span></code> (2).</p></li>
</ul>
</td>
<td><p>The sequences to apply the algorithm to.
Supported sequence types:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../parallel_api/pass_data_algorithms.html#use-usm"><span class="std std-ref">USM pointers</span></a> (1),</p></li>
<li><p><a class="reference internal" href="../parallel_api/pass_data_algorithms.html#use-buffer-wrappers"><span class="std std-ref">oneapi::dpl::begin and oneapi::dpl::end</span></a> (1),</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sycl::buffer</span></code> (2),</p></li>
<li><p><a class="reference internal" href="../parallel_api/range_based_api.html#viewable-ranges"><span class="std std-ref">oneapi::dpl::experimental::ranges::views::all</span></a> (2),</p></li>
<li><p><a class="reference internal" href="../parallel_api/range_based_api.html#viewable-ranges"><span class="std std-ref">oneapi::dpl::experimental::ranges::views::subrange</span></a> (2).</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">binary_op</span></code></p></td>
<td><p>A function object that is applied to the elements of the input.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">param</span></code></p></td>
<td><p>A <a class="reference internal" href="kernel_configuration.html"><span class="doc">kernel_param</span></a> object.</p></td>
</tr>
</tbody>
</table>
<p><strong>Type Requirements</strong>:</p>
<ul class="simple">
<li><p>The element type of sequence to scan must be a 32-bit or 64-bit bit C++ integral or floating-point type.</p></li>
<li><p>The result is non-deterministic if the binary operator is non-associative (such as in floating-point addition)
or non-commutative.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Current limitations:</p>
<ul class="simple">
<li><p>The function will internally block until the issued kernels have completed execution.
Although intended in the future to be an asynchronous call, the algorithm is currently synchronous.</p></li>
<li><p>The SYCL device associated with the provided queue must support 64-bit atomic operations if the element type is 64-bits.</p></li>
<li><p>There must be a known identity value for the provided combination of the element type and the binary operation. That is, <code class="docutils literal notranslate"><span class="pre">sycl::has_known_identity_v</span></code> must evaluate to true. Such operators are listed in the <a class="reference external" href="https://registry.khronos.org/SYCL/specs/sycl-2020/html/sycl-2020.html#table.identities">SYCL 2020 specification</a>.</p></li>
</ul>
</div>
</div>
<div class="section" id="return-value">
<h3>Return Value<a class="headerlink" href="#return-value" title="Permalink to this headline">#</a></h3>
<p>A <code class="docutils literal notranslate"><span class="pre">sycl::event</span></code> object representing the status of the algorithm execution.</p>
</div>
</div>
<div class="section" id="usage-examples">
<h2>Usage Examples<a class="headerlink" href="#usage-examples" title="Permalink to this headline">#</a></h2>
<div class="section" id="inclusive-scan-example">
<h3>inclusive_scan Example<a class="headerlink" href="#inclusive-scan-example" title="Permalink to this headline">#</a></h3>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// possible build and run commands:</span>
<span class="c1">//    icpx -fsycl inclusive_scan.cpp -o inclusive_scan -I /path/to/oneDPL/include &amp;&amp; ./inclusive_scan</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;cstdint&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;sycl/sycl.hpp&gt;</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;oneapi/dpl/experimental/kernel_templates&gt;</span>

<span class="k">namespace</span><span class="w"> </span><span class="nn">kt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nn">oneapi</span><span class="o">::</span><span class="nn">dpl</span><span class="o">::</span><span class="nn">experimental</span><span class="o">::</span><span class="nn">kt</span><span class="p">;</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">   </span><span class="n">std</span><span class="o">::</span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span>
<span class="w">   </span><span class="n">sycl</span><span class="o">::</span><span class="n">queue</span><span class="w"> </span><span class="n">q</span><span class="p">{</span><span class="n">sycl</span><span class="o">::</span><span class="n">gpu_selector_v</span><span class="p">};</span>
<span class="w">   </span><span class="n">std</span><span class="o">::</span><span class="kt">uint32_t</span><span class="o">*</span><span class="w"> </span><span class="n">arr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sycl</span><span class="o">::</span><span class="n">malloc_shared</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="kt">uint32_t</span><span class="o">&gt;</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">q</span><span class="p">);</span>
<span class="w">   </span><span class="n">std</span><span class="o">::</span><span class="kt">uint32_t</span><span class="o">*</span><span class="w"> </span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sycl</span><span class="o">::</span><span class="n">malloc_shared</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="kt">uint32_t</span><span class="o">&gt;</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">q</span><span class="p">);</span>

<span class="w">   </span><span class="c1">// initialize</span>
<span class="w">   </span><span class="n">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">arr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">arr</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">arr</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">arr</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">arr</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>

<span class="w">   </span><span class="c1">// scan</span>
<span class="w">   </span><span class="k">auto</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">kt</span><span class="o">::</span><span class="n">gpu</span><span class="o">::</span><span class="n">inclusive_scan</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="w"> </span><span class="n">arr</span><span class="p">,</span><span class="w"> </span><span class="n">arr</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">out</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">plus</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="kt">uint32_t</span><span class="o">&gt;</span><span class="p">{},</span><span class="w"> </span><span class="n">kt</span><span class="o">::</span><span class="n">kernel_param</span><span class="o">&lt;</span><span class="mi">256</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="o">&gt;</span><span class="p">{});</span>
<span class="w">   </span><span class="n">e</span><span class="p">.</span><span class="n">wait</span><span class="p">();</span>

<span class="w">   </span><span class="c1">// print</span>
<span class="w">   </span><span class="k">for</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span>
<span class="w">      </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="sc">&#39; &#39;</span><span class="p">;</span>
<span class="w">   </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="sc">&#39;\n&#39;</span><span class="p">;</span>

<span class="w">   </span><span class="n">sycl</span><span class="o">::</span><span class="n">free</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span><span class="w"> </span><span class="n">q</span><span class="p">);</span>
<span class="w">   </span><span class="n">sycl</span><span class="o">::</span><span class="n">free</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="w"> </span><span class="n">q</span><span class="p">);</span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Output:</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>1 3 4 7 8 10
</pre></div>
</div>
</div>
</div>
<div class="section" id="memory-requirements">
<span id="scan-memory-requirements"></span><h2>Memory Requirements<a class="headerlink" href="#memory-requirements" title="Permalink to this headline">#</a></h2>
<p>The algorithm uses global and local device memory (see <a class="reference external" href="https://registry.khronos.org/SYCL/specs/sycl-2020/html/sycl-2020.html#_sycl_device_memory_model">SYCL 2020 Specification</a>)
for intermediate data storage. For the algorithm to operate correctly, there must be enough memory
on the device. It throws a <code class="docutils literal notranslate"><span class="pre">std::bad_alloc</span></code> exception if there is not enough global device memory. The behavior is undefined if there is not enough local memory. The amount of memory that is required
depends on input data and configuration parameters, as described below.</p>
<div class="section" id="global-memory-requirements">
<h3>Global Memory Requirements<a class="headerlink" href="#global-memory-requirements" title="Permalink to this headline">#</a></h3>
<p>Global memory is used for copying the input sequence and storing internal data such as status flags.
The used amount depends on many parameters; below is an approximation in bytes:</p>
<p>2 * V * N <sub>flags</sub> + 4 * N <sub>flags</sub></p>
<p>where V is the number of bytes needed to store the input value type.</p>
<p>The value of N<sub>flags</sub> represents the number of work-groups and depends on <code class="docutils literal notranslate"><span class="pre">param.data_per_workitem</span></code> and <code class="docutils literal notranslate"><span class="pre">param.workgroup_size</span></code>.
It can be approximated by dividing the number of input elements N by the product of <code class="docutils literal notranslate"><span class="pre">param.data_per_workitem</span></code> and <code class="docutils literal notranslate"><span class="pre">param.workgroup_size</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the number of input elements can be efficiently processed by a single work-group,
the kernel template is executed by a single work-group and does not use any global memory.</p>
</div>
</div>
<div class="section" id="local-memory-requirements">
<h3>Local Memory Requirements<a class="headerlink" href="#local-memory-requirements" title="Permalink to this headline">#</a></h3>
<p>Local memory is used for storing elements of the input that are to be scanned by a single work-group.
The used amount is denoted as N<sub>elems_per_workgroup</sub>, which equals to <code class="docutils literal notranslate"><span class="pre">sizeof(key_type)</span> <span class="pre">*</span> <span class="pre">param.data_per_workitem</span> <span class="pre">*</span> <span class="pre">param.workgroup_size</span></code>.</p>
<p>Some amount of local memory is also used by the calls to SYCL’s group reduction and group scan. The amount of memory used particularly
for these calls is implementation dependent.</p>
</div>
</div>
<div class="section" id="recommended-settings-for-best-performance">
<h2>Recommended Settings for Best Performance<a class="headerlink" href="#recommended-settings-for-best-performance" title="Permalink to this headline">#</a></h2>
<p>The general advice is to choose kernel parameters based on performance measurements and profiling information.
The initial configuration may be selected according to these high-level guidelines:</p>
<ul class="simple">
<li><p>When the number of elements is small enough to fit within single work-group, the algorithm will ignore kernel
parameters and instead dispatch to a single work-group version, where it is generally more efficient.</p></li>
<li><p>Generally, utilizing all available
compute cores is key for better performance. To allow sufficient work to satisfy all
X<sup>e</sup>-cores <a class="footnote-reference brackets" href="#fnote2" id="id2">2</a> on a GPU, use <code class="docutils literal notranslate"><span class="pre">param.data_per_workitem</span> <span class="pre">*</span> <span class="pre">param.workgroup_size</span> <span class="pre">≈</span> <span class="pre">N</span> <span class="pre">/</span> <span class="pre">xe_core_count</span></code>.</p></li>
<li><p>On devices with multiple tiles, it may prove beneficial to experiment with different tile hierarchies as described
in <a class="reference external" href="https://www.intel.com/content/www/us/en/developer/articles/technical/flattening-gpu-tile-hierarchy.html">Options for using a GPU Tile Hierarchy</a>.</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Avoid setting too large <code class="docutils literal notranslate"><span class="pre">param.data_per_workitem</span></code> and <code class="docutils literal notranslate"><span class="pre">param.workgroup_size</span></code> values.
Make sure that <a class="reference internal" href="#scan-memory-requirements"><span class="std std-ref">Memory requirements</span></a> are satisfied.</p>
</div>
<dl class="footnote brackets">
<dt class="label" id="fnote1"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>Merrill, D., Garland, M.: Single-pass Parallel Prefix Scan with Decoupled Look-back. Technical Report NVR-2016-002, NVIDIA (2016)</p>
</dd>
<dt class="label" id="fnote2"><span class="brackets"><a class="fn-backref" href="#id2">2</a></span></dt>
<dd><p>The X<sup>e</sup>-core term is described in the <a class="reference external" href="https://www.intel.com/content/www/us/en/docs/oneapi/optimization-guide-gpu/2024-0/intel-xe-gpu-architecture.html#XE-CORE">oneAPI GPU Optimization Guide</a>.
Check the number of cores in the device specification, such as <a class="reference external" href="https://www.intel.com/content/www/us/en/products/details/discrete-gpus/data-center-gpu/max-series/products.html">Intel® Data Center GPU Max specification</a>.</p>
</dd>
</dl>
</div>
</div>


                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="esimd/radix_sort.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Radix Sort</p>
      </div>
    </a>
    <a class="right-next"
       href="../macros.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Macros</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#inclusive-scan-function-template">inclusive_scan Function Template</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#parameters">Parameters</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#return-value">Return Value</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#usage-examples">Usage Examples</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inclusive-scan-example">inclusive_scan Example</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#memory-requirements">Memory Requirements</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#global-memory-requirements">Global Memory Requirements</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#local-memory-requirements">Local Memory Requirements</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#recommended-settings-for-best-performance">Recommended Settings for Best Performance</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Intel
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright Intel Corporation.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <p align="right"><a data-cookie-notice="true" href="https://www.intel.com/content/www/us/en/privacy/intel-cookie-notice.html">Cookies</a></p>
</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>